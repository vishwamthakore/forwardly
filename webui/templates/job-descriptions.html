{% extends 'base.html' %}

{% block content %}
  

  {% if job_descriptions %}
    <div id="resumeList" class="vstack gap-3">
      {% for jd in job_descriptions %}
        <div class="card resume-card" data-id="{{ jd.id }}">
          <div class="card-body d-flex justify-content-between align-items-center">
            <div>
              <div class="file-name">{{ jd.name }}</div>
              <div class="muted-label">Job Description ID {{ jd.id }}</div>
              <div class="muted-label">Created At {{ jd.created_at }}</div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <div>Selected Resume <span id="resume-id">{{ resume_id }}</span></div>

    <div class="mt-4 text-end">
      <a id="continueBtn" class="btn btn-primary disabled">Continue</a>
    </div>
  {% else %}
    <div class="text-muted">No Job Descriptions uploaded yet</div>
  {% endif %}

 <script>
    // -----------------------------------------------------------------------------
    var selectedJobId = null
    
    var cards = document.querySelectorAll('.resume-card')
    var continueBtn = document.getElementById('continueBtn')
    var resumeId = document.getElementById('resume-id').innerHTML;
    
    for (var i = 0; i < cards.length; i++) {
      cards[i].addEventListener('click', selectJobCard)
    }
    
    continueBtn.addEventListener('click', continueToNext)
    
    function continueToNext(event) {
      event.preventDefault()
    
      if (selectedJobId !== null) {
        window.location.href = `/ui/analysis/${resumeId}/${selectedJobId}`
      }
    }
    
    function selectJobCard(event) {
      // Remove previous selection
      for (var j = 0; j < cards.length; j++) {
        cards[j].classList.remove('selected')
      }
    
      // Mark clicked card
      this.classList.add('selected')
    
      // Store id
      selectedJobId = this.getAttribute('data-id')
    
      // Enable button
      continueBtn.classList.remove('disabled')
    }
</script>

{% endblock %}

